@startuml Class Diagram
!theme plain
skinparam classAttributeIconSize 0
skinparam defaultFontSize 16
skinparam classFontSize 20
skinparam classFontStyle bold
skinparam packageFontSize 18
skinparam packageFontStyle bold
skinparam arrowThickness 2
skinparam shadowing false
skinparam minClassWidth 150
skinparam maxClassWidth 300
skinparam linetype ortho

title ApplyCrypto 클래스 다이어그램 (1/2)

package "CLI" {
  class CLIController
}

package "Config" {
  class ConfigurationManager
  class ConfigurationError
}

package "Collector" {
  class SourceFileCollector
}

package "Parser" {
  class JavaASTParser
  class ClassInfo
  class XMLMapperParser
  class SQLQuery
  class CallGraphBuilder
  class Endpoint
  abstract class EndpointExtractionStrategy
  class SpringMVCEndpointExtraction
  class AnyframeSarangOnEndpointExtraction
  class EndpointExtractionStrategyFactory
}

package "Analyzer" {
  class DBAccessAnalyzer
  abstract class SQLExtractor
  class MyBatisSQLExtractor
  class JDBCSQLExtractor
  class JPASQLExtractor
  class AnyframeJDBCSQLExtractor
  class SQLExtractorFactory
}

' 관계 정의 (Page 1)
CLIController --> ConfigurationManager
CLIController --> SourceFileCollector
CLIController --> JavaASTParser
CLIController --> XMLMapperParser
CLIController --> CallGraphBuilder
CLIController --> DBAccessAnalyzer

SourceFileCollector --> ConfigurationManager
SourceFileCollector --> SourceFile

JavaASTParser --> CacheManager
JavaASTParser --> ClassInfo
JavaASTParser --> Method

XMLMapperParser --> SQLQuery
XMLMapperParser --> TableAccessInfo

CallGraphBuilder --> JavaASTParser
CallGraphBuilder --> CacheManager
CallGraphBuilder --> Endpoint
CallGraphBuilder --> Method
CallGraphBuilder --> CallRelation
CallGraphBuilder --> EndpointExtractionStrategy
EndpointExtractionStrategy <|-- SpringMVCEndpointExtraction
EndpointExtractionStrategy <|-- AnyframeSarangOnEndpointExtraction
EndpointExtractionStrategyFactory --> EndpointExtractionStrategy
EndpointExtractionStrategyFactory --> SpringMVCEndpointExtraction
EndpointExtractionStrategyFactory --> AnyframeSarangOnEndpointExtraction

DBAccessAnalyzer --> ConfigurationManager
DBAccessAnalyzer --> XMLMapperParser
DBAccessAnalyzer --> JavaASTParser
DBAccessAnalyzer --> CallGraphBuilder
DBAccessAnalyzer --> SQLExtractor
DBAccessAnalyzer --> TableAccessInfo
SQLExtractor <|-- MyBatisSQLExtractor
SQLExtractor <|-- JDBCSQLExtractor
SQLExtractor <|-- JPASQLExtractor
SQLExtractor <|-- AnyframeJDBCSQLExtractor
SQLExtractorFactory --> SQLExtractor
SQLExtractorFactory --> MyBatisSQLExtractor
SQLExtractorFactory --> JDBCSQLExtractor
SQLExtractorFactory --> JPASQLExtractor
SQLExtractorFactory --> AnyframeJDBCSQLExtractor

newpage

title ApplyCrypto 클래스 다이어그램 (2/2)

package "Modifier" {
  class CodeModifier
  abstract class BaseCodeGenerator
  class ControllerOrServiceCodeGenerator
  class ServiceImplOrBizCodeGenerator
  class TypeHandlerCodeGenerator
  class CodeGeneratorFactory
  class ContextGenerator
  class BatchProcessor
  class CodePatcher
  class ErrorHandler
  class ResultTracker
  class PromptTemplateManager
}

package "LLM" {
  abstract class LLMProvider
  class LLMFactory
  class WatsonXAIProvider
  class OpenAIProvider
  class ClaudeAIProvider
}

package "Persistence" {
  class DataPersistenceManager
  class CacheManager
}

package "Models" {
  class SourceFile
  class TableAccessInfo
  class Method
  class Parameter
  class CallRelation
  class ModificationRecord
}

' 관계 정의 (Page 2)
CLIController --> CodeModifier
CLIController --> DataPersistenceManager

CodeModifier --> ConfigurationManager
CodeModifier --> BaseCodeGenerator
CodeModifier --> CodePatcher
CodeModifier --> ErrorHandler
CodeModifier --> ResultTracker
CodeModifier --> TableAccessInfo
BaseCodeGenerator <|-- ControllerOrServiceCodeGenerator
BaseCodeGenerator <|-- ServiceImplOrBizCodeGenerator
BaseCodeGenerator <|-- TypeHandlerCodeGenerator
CodeGeneratorFactory --> BaseCodeGenerator
CodeGeneratorFactory --> ControllerOrServiceCodeGenerator
CodeGeneratorFactory --> ServiceImplOrBizCodeGenerator
CodeGeneratorFactory --> TypeHandlerCodeGenerator
ControllerOrServiceCodeGenerator --> ContextGenerator
ControllerOrServiceCodeGenerator --> BatchProcessor
ControllerOrServiceCodeGenerator --> PromptTemplateManager
ControllerOrServiceCodeGenerator --> LLMProvider
BatchProcessor --> PromptTemplateManager
BatchProcessor --> LLMProvider

CodePatcher --> ErrorHandler

ResultTracker --> ModificationRecord

LLMFactory --> LLMProvider
WatsonXAIProvider ..|> LLMProvider
OpenAIProvider ..|> LLMProvider
ClaudeAIProvider ..|> LLMProvider

DataPersistenceManager --> CacheManager
DataPersistenceManager --> SourceFile
DataPersistenceManager --> TableAccessInfo
DataPersistenceManager --> Method
DataPersistenceManager --> CallRelation
DataPersistenceManager --> ModificationRecord

Method --> Parameter

@enduml
